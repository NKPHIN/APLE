2025-05-17 00:05:22.909364: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-05-17 00:05:23.995442: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Namespace(add_num_times=2, alpha=0.4, anneal_cap=0.2, bert_mask_prob=0.3, best_metric='NDCG@10', block_num=2, cand_num=100, ch=True, context_window=2, dataset_path='Tenrec/ctr_data_0.1M.csv', decay_step=5, device='cuda', dilations=[1, 4], dropout=0.3, early_stop=True, embedding_size=32, epochs=20, eval=True, factor_num=128, gamma=0.5, hidden_size=128, hidden_size_list=[128, 128], init_method='default', is_mp=False, is_parallel=False, is_pretrain=1, item_min=10, k=20, kd=False, kernel_size=3, l2_emb=0.0, latent_dim=128, lifelong_eval=True, ll_max_itemnum=0, local_rank=None, loss_type='BPR', lr=5e-06, max_len=20, mess_dropout=0.1, metric_ks=[5, 20], model_name='ple', mtl_task_num=2, negsample_savefolder='./data/neg_data/', negsample_size=99, node_dropout=0.1, num_embedding=1, num_gpu=1, num_groups=4, num_heads=4, num_items=1, num_labels=1, num_ng=4, num_users=1, optimizer='default', pad_token=0, pretrain_path='', prun_rate=0, re_epochs=20, reg_1=0.0, reg_2=0.0, rho=0.5, sample='random', sample_method='high-pop', sample_ratio=0.3, save_path='./checkpoint/', seed=100, source_path='', target_path='', task=-1, task1_out=0, task2_out=0, task3_out=0, task4_out=0, task_name='mtl', task_num=4, temp=7, test_batch_size=512, test_method='ufo', test_size=0.1, total_anneal_steps=1000, train_batch_size=512, user_profile='gender', val_batch_size=512, val_method='ufo', val_size=0.1111, valid_rate=100, weight_decay=0.0)

  0%|          | 0/15 [00:00<?, ?it/s]
  7%|▋         | 1/15 [00:02<00:36,  2.63s/it]
 13%|█▎        | 2/15 [00:05<00:32,  2.51s/it]
 20%|██        | 3/15 [00:06<00:26,  2.23s/it]
 27%|██▋       | 4/15 [00:07<00:17,  1.60s/it]
 33%|███▎      | 5/15 [00:08<00:12,  1.24s/it]
 40%|████      | 6/15 [00:10<00:14,  1.62s/it]
 47%|████▋     | 7/15 [00:12<00:14,  1.83s/it]
 53%|█████▎    | 8/15 [00:15<00:14,  2.02s/it]
 60%|██████    | 9/15 [00:17<00:13,  2.18s/it]
 67%|██████▋   | 10/15 [00:20<00:11,  2.27s/it]
 73%|███████▎  | 11/15 [00:22<00:09,  2.35s/it]
 80%|████████  | 12/15 [00:25<00:07,  2.41s/it]
 87%|████████▋ | 13/15 [00:27<00:04,  2.42s/it]
 93%|█████████▎| 14/15 [00:30<00:02,  2.43s/it]
100%|██████████| 15/15 [00:32<00:00,  2.48s/it]
100%|██████████| 15/15 [00:32<00:00,  2.19s/it]

0it [00:00, ?it/s]
1it [00:00,  5.69it/s]
2it [00:00,  5.55it/s]
4it [00:00,  8.84it/s]
6it [00:00, 10.59it/s]
8it [00:00, 10.10it/s]
10it [00:01,  9.99it/s]
12it [00:01,  9.88it/s]
14it [00:01,  9.86it/s]
15it [00:01,  9.81it/s]
17it [00:01, 10.74it/s]

Epoch 1 train loss is 0.803, click auc is 0.504 and like auc is 0.540
Epoch 1 val loss is 0.732, click auc is 0.527 and like auc is 0.646
Epoch 2 train loss is 0.728, click auc is 0.537 and like auc is 0.652
Epoch 2 val loss is 0.725, click auc is 0.543 and like auc is 0.662
Epoch 3 train loss is 0.725, click auc is 0.546 and like auc is 0.667
Epoch 3 val loss is 0.723, click auc is 0.548 and like auc is 0.672
Epoch 4 train loss is 0.723, click auc is 0.552 and like auc is 0.677
Epoch 4 val loss is 0.722, click auc is 0.553 and like auc is 0.678
Epoch 5 train loss is 0.722, click auc is 0.559 and like auc is 0.686
Epoch 5 val loss is 0.721, click auc is 0.560 and like auc is 0.685
Epoch 6 train loss is 0.721, click auc is 0.566 and like auc is 0.694
Epoch 6 val loss is 0.720, click auc is 0.566 and like auc is 0.690
Epoch 7 train loss is 0.719, click auc is 0.574 and like auc is 0.703
Epoch 7 val loss is 0.719, click auc is 0.572 and like auc is 0.696
Epoch 8 train loss is 0.717, click auc is 0.581 and like auc is 0.711
Epoch 8 val loss is 0.718, click auc is 0.578 and like auc is 0.702
Epoch 9 train loss is 0.715, click auc is 0.588 and like auc is 0.719
Epoch 9 val loss is 0.716, click auc is 0.584 and like auc is 0.707
Epoch 10 train loss is 0.713, click auc is 0.595 and like auc is 0.727
Epoch 10 val loss is 0.715, click auc is 0.589 and like auc is 0.712
Epoch 11 train loss is 0.711, click auc is 0.601 and like auc is 0.735
Epoch 11 val loss is 0.713, click auc is 0.594 and like auc is 0.718
Epoch 12 train loss is 0.709, click auc is 0.607 and like auc is 0.743
Epoch 12 val loss is 0.712, click auc is 0.599 and like auc is 0.723
Epoch 13 train loss is 0.706, click auc is 0.613 and like auc is 0.750
Epoch 13 val loss is 0.710, click auc is 0.604 and like auc is 0.727
Epoch 14 train loss is 0.704, click auc is 0.619 and like auc is 0.758
Epoch 14 val loss is 0.709, click auc is 0.608 and like auc is 0.731
Epoch 15 train loss is 0.701, click auc is 0.625 and like auc is 0.764
Epoch 15 val loss is 0.707, click auc is 0.612 and like auc is 0.734
Epoch 16 train loss is 0.698, click auc is 0.630 and like auc is 0.771
Epoch 16 val loss is 0.706, click auc is 0.616 and like auc is 0.738
Epoch 17 train loss is 0.696, click auc is 0.635 and like auc is 0.776
Epoch 17 val loss is 0.704, click auc is 0.620 and like auc is 0.741
Epoch 18 train loss is 0.693, click auc is 0.640 and like auc is 0.782
Epoch 18 val loss is 0.703, click auc is 0.623 and like auc is 0.744
Epoch 19 train loss is 0.690, click auc is 0.645 and like auc is 0.787
Epoch 19 val loss is 0.702, click auc is 0.627 and like auc is 0.746
Epoch 20 train loss is 0.688, click auc is 0.650 and like auc is 0.791
Epoch 20 val loss is 0.700, click auc is 0.630 and like auc is 0.749
Epoch 20 test loss is 0.699, click auc is 0.631 and like auc is 0.749
